<div class="flex justify-center min-h-screen">
  <div class="flex flex-col flex-wrap mt-6 mr-8">
    <h2 class="text-lg font-semibold text-gray-800">Filter & Sort</h2>
    
    <%= form_with url: category_path(@category), method: :get, class: "flex flex-col mt-4", data: { testid: "filter-form" } do |form| %>
      <%# Sort options %>
      <label class="text-sm font-medium text-gray-700 mb-1">Sort By</label>
      <%= form.select :sort, 
          options_for_select([
            ["Name (A-Z)", "name_asc"],
            ["Name (Z-A)", "name_desc"],
            ["Price (Low to High)", "price_asc"],
            ["Price (High to Low)", "price_desc"],
            ["Newest", "newest"]
          ], params[:sort]),
          { include_blank: "Default" },
          class: "border border-gray-300 rounded-md p-2 w-48 mb-4" %>
      
      <%# Price filter %>
      <label class="text-sm font-medium text-gray-700 mb-1">Price Range (pence)</label>
      <%= form.number_field :min, value: params[:min], placeholder: "Min Price", class: "border border-gray-300 rounded-md p-2 w-48 mb-2" %>
      <%= form.number_field :max, value: params[:max], placeholder: "Max Price", class: "border border-gray-300 rounded-md p-2 w-48 mb-4" %>
      
      <%# Weight filter %>
      <label class="text-sm font-medium text-gray-700 mb-1">Weight Range (grams)</label>
      <%= form.number_field :weight_min, value: params[:weight_min], placeholder: "Min Weight", class: "border border-gray-300 rounded-md p-2 w-48 mb-2" %>
      <%= form.number_field :weight_max, value: params[:weight_max], placeholder: "Max Weight", class: "border border-gray-300 rounded-md p-2 w-48 mb-4" %>
      
      <%# Fiberglass filter %>
      <label class="flex items-center text-sm font-medium text-gray-700 mb-4">
        <%= form.check_box :fiberglass, { checked: params[:fiberglass] == "1" }, "1", "0" %>
        <span class="ml-2">Fiberglass Reinforcement</span>
      </label>
      
      <%= form.submit "Apply Filters", class: "bg-blue-600 text-white rounded-md p-2 mt-2 cursor-pointer hover:bg-blue-700 transition" %>
    <% end %>
    
    <%= link_to "Clear Filters", category_path(@category), class: "bg-gray-500 text-white rounded-md p-2 mt-2 text-center cursor-pointer hover:bg-gray-600 transition", data: { testid: "clear-filters" } %>
  </div>
  
  <div class="flex flex-col flex-grow mt-6">
    <%# Product count display %>
    <div class="mb-4 text-gray-600" data-testid="product-count">
      <span class="font-medium"><%= @product_count %></span> <%= @product_count == 1 ? "product" : "products" %> found
    </div>
    
    <div class="flex flex-wrap items-start justify-start gap-10">
      <% if @products.empty? %>
        <p class="text-2xl text-left text-gray-800">No products found</p>
      <% else %>
        <% @products.each do |product| %>
          <%= link_to product_path(product) do %>
            <div class="flex flex-col items-center justify-center max-w-xs p-4 hover:shadow-lg rounded-lg transition">
              <%= product.images.first ? lazy_image_tag(product.images.first.variant(:medium), class: "rounded") : lazy_image_tag("http://via.placeholder.com/250", class: "rounded") %>
              <p class="mt-6 font-medium text-gray-800"><%= product.name %></p>
            </div>
          <% end %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
<div class="py-5 my-10 text-center text-white bg-blue-600">
</div>

